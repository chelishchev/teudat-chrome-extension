(()=>{"use strict";class e{constructor(){this.departments=this.loadData(),this.cache=new Map}#e(e){const t=new Uint16Array(e.length);for(let i=0;i<t.length;i++)t[i]=e.charCodeAt(i);return btoa(String.fromCharCode(...new Uint8Array(t.buffer)))}#t(e){const t=atob(e),i=new Uint8Array(t.length);for(let e=0;e<i.length;e++)i[e]=t.charCodeAt(e);return String.fromCharCode(...new Uint16Array(i.buffer))}#i(e){e.hasProcessed||(e.LocationName=this.#t(e.LocationName),e.Label=e.ExtRef.replace(/ShowDate_/g,""),e.hasProcessed=!0)}getNodeOnPage(e){this.#i(e);const t=e.LocationName.replace(/"/g,'\\"');return this.cache.has(t)||this.cache.set(t,document.body.querySelector(`span[title="${t}"]`)),this.cache.get(t)}highlightAddress(e,t){const{color:i,text:a}=t;let n=this.getNodeOnPage(e);n&&(n.style.backgroundColor=i,n.textContent=`${a} in ${n.textContent}`)}getGoodDepartmentServiceIds(){return[2161,2243,2155,2099,2163,2165,2095,2153,2113,2245,2167,2110,2150,2146,2215,2159,2219]}[Symbol.iterator](){let e=0;const t=this.getDepartments();return{next:()=>{if(e<t.length)for(let i=e;i<t.length;i++){let a=t[i];if(this.getGoodDepartmentServiceIds().includes(a.ServiceId))return this.#i(a),e=i,e++,{value:a,done:!1}}return{done:!0}}}}loadData(){return[{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:825,LocationName:"3AXpBdsF6gUgANkF6AXVBekF3AXZBd0FIADTBegF1QXdBS0A1AXoBSAA1wXVBd4F1AU=",Address1:"אליהו קורן 25",Address2:"",City:"ירושלים",State:"ישראל",Country:"Israel",Description:"לשכת ירושלים דרום- הר חומה",Directions:"",ZipCode:"",Latitude:31.7221755,Longitude:35.2235026,Distance:57732.09167767383,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"2022-11-21T07:11:20.577",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2161,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_SouthJer",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:870,LocationName:"3AXpBdsF6gUgAN4F1gXoBdcFIADZBegF1QXpBdwF2QXdBSAANAYxBkIGIAAnBkQGQgYvBjMG",Address1:"וואדי ג'וז 49",Address2:"",City:"ירושלים",State:"ישראל",Country:"Israel",Description:"לשכת מזרח ירושלים شرق القدس",Directions:"",ZipCode:"",Latitude:31.7943863,Longitude:35.2361106,Distance:53489.41225529979,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2243,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_EastJer",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:822,LocationName:"3AXpBdsF6gUgANkF6AXVBekF3AXZBd0FLQDpBdwF1QXeBeYF2QXVBd8FIADUBd4F3AXbBdQFIAAxAA==",Address1:"שלומציון המלכה 1",Address2:"",City:"ירושלים",State:"ישראל",Country:"Israel",Description:"לשכת ירושלים-שלומציון המלכה 1",Directions:"",ZipCode:"",Latitude:31.7802595,Longitude:35.2217376,Distance:53365.774854175914,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2155,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Jerusalem",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:802,LocationName:"3AXpBdsF6gUgAOoF3AUgANAF0QXZBdEFIADeBegF2wXWBSAAKADnBegF2QXZBeoFIADUBd4F3gXpBdwF1AUpAA==",Address1:"מנחם בגין 125",Address2:"",City:"תל אביב",State:"ישראל",Country:"Yemen",Description:"לשכת תל אביב מרכז (קריית הממשלה)",Directions:"",ZipCode:"",Latitude:32.0729837,Longitude:34.7891528,Distance:1151.3467701184543,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2099,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_TelAviv",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:827,LocationName:"3AXpBdsF6gUgAOoFIgDQBSAA0wXoBdUF3QUgACgA2QXkBdUFKQA=",Address1:"סלמה 53",Address2:"קומה 4",City:"תל אביב",State:"ישראל",Country:"Israel",Description:'לשכת ת"א דרום (יפו)',Directions:"",ZipCode:"",Latitude:32.0550936,Longitude:34.7671014,Distance:3068.0781561746026,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2165,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Yaffo",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:799,LocationName:"3AXpBdsF6gUgAOgF3gXqBSAA0gXfBS0A0gXRBeIF6gXZBdkF3QU=",Address1:"סירקין 17",Address2:"",City:"גבעתיים",State:"ישראל",Country:"Israel",Description:"לשכת רמת גן גבעתיים",Directions:"",ZipCode:"",Latitude:32.0783511,Longitude:34.8153998,Distance:3302.0289368901335,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2095,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_RamatGan",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:826,LocationName:"3AXpBdsF6gUgANEF4AXZBSAA0QXoBecF",Address1:"דרך זאב ז'בוטינסקי 168",Address2:"מגדל מניבים",City:"בני ברק",State:"ישראל",Country:"Israel",Description:"לשכת בני ברק",Directions:"",ZipCode:"",Latitude:32.0924964,Longitude:34.8389245,Distance:5678.923782407623,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"2022-11-30T05:35:11.063",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2163,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_BneiBrak",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:821,LocationName:"3AXpBdsF6gUgANcF1QXcBdUF3wU=",Address1:"שדרות ירושלים 164",Address2:"",City:"חולון",State:"ישראל",Country:"Israel",Description:"לשכת חולון",Directions:"",ZipCode:"",Latitude:32.0129607,Longitude:34.7922471,Distance:7549.066599896487,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2153,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Holon",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:809,LocationName:"3AXpBdsF6gUgAOQF6gXXBSAA6gXnBdUF1AU=",Address1:"מוטה גור 4",Address2:"מגדלי עופר",City:"פתח תקוה",State:"ישראל",Country:"Israel",Description:"לשכת פתח תקוה",Directions:"",ZipCode:"",Latitude:32.0934298,Longitude:34.8649632,Distance:8105.492394416186,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2113,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_PetachTikva",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:871,LocationName:"3AXpBdsF6gUgANQF6AXmBdwF2QXUBQ==",Address1:"ברקת 11",Address2:"",City:"הרצליה",State:"ישראל",Country:"Israel",Description:"לשכת הרצליה",Directions:"",ZipCode:"",Latitude:32.1647816,Longitude:34.8127265,Distance:9849.329986181157,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2245,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Herzelia",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:869,LocationName:"3AXpBdsF6gUgAOgF0AXpBdUF3wUgANwF5gXZBdUF3wU=",Address1:"ישראל גלילי 3",Address2:"",City:"ראשון לציון",State:"ישראל",Country:"Israel",Description:"לשכת ראשון לציון",Directions:"קריית הממשלה",ZipCode:"",Latitude:31.9690906,Longitude:34.7817391,Distance:12332.259173291743,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2241,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Rashlatz",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:828,LocationName:"3AXpBdsF6gUgAOgF0AXpBSAA1AXiBdkF3wU=",Address1:"שלום שבזי 29",Address2:"",City:"ראש העין",State:"ישראל",Country:"Israel",Description:"לשכת ראש העין",Directions:"",ZipCode:"",Latitude:32.0966912,Longitude:34.9438254,Distance:15525.051313961876,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2167,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_RoshHaAin",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:807,LocationName:"3AXpBdsF6gUgANsF5AXoBSAA4QXRBdAF",Address1:"ויצמן 140 ",Address2:"",City:"כפר סבא",State:"ישראל",Country:"Israel",Description:"לשכת כפר סבא",Directions:"",ZipCode:"",Latitude:32.1744141,Longitude:34.911686,Distance:16191.18826451221,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2110,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_KfarSaba",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:818,LocationName:"3AXpBdsF6gUgAOgF3gXcBdQF",Address1:"הרצל 91",Address2:"",City:"רמלה",State:"ישראל",Country:"Israel",Description:"לשכת רמלה",Directions:"",ZipCode:"",Latitude:31.9262671,Longitude:34.8770731,Distance:19364.987250539358,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2148,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Ramle",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:819,LocationName:"3AXpBdsF6gUgAOgF1wXVBdEF1QXqBQ==",Address1:"מוטי קינד 10",Address2:"",City:"רחובות",State:"ישראל",Country:"Israel",Description:"לשכת רחובות",Directions:"",ZipCode:"",Latitude:31.8946742,Longitude:34.7894096,Distance:20600.62706989264,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2150,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Rehovot",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:817,LocationName:"3AXpBdsF6gUgAOAF6gXgBdkF1AU=",Address1:"דוד רמז 13",Address2:"",City:"נתניה",State:"ישראל",Country:"Israel",Description:"לשכת נתניה",Directions:"",ZipCode:"",Latitude:32.3279834,Longitude:34.8533843,Distance:28312.296226724873,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2146,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Netanya",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:823,LocationName:"3AXpBdsF6gUgAN4F1QXTBdkF4gXZBd8FLQDeBdsF0QXZBd0FLQDoBeIF1QXqBSAAKADcBeoF1QXpBdEF2QUgANQF4gXZBegFIADRBdwF0QXTBSkA",Address1:"תלתן 1",Address2:"",City:"מודיעין",State:"ישראל",Country:"Israel",Description:"לשכת מודיעין-מכבים-רעות (לתושבי העיר בלבד)",Directions:"בנין עיריה",ZipCode:"",Latitude:31.9076585,Longitude:35.0076201,Distance:28759.7901924211,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2157,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Modiin",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:979,LocationName:"3AXpBdsF6gUgANgF2QXZBdEF1AU=",Address1:"אלבלדיה",Address2:"",City:"טייבה",State:"ישראל",Country:"Israel",Description:"לשכת טייבה",Directions:"",ZipCode:"",Latitude:32.266375,Longitude:35.00272,Distance:29411.21458429051,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2749,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Taybe",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:899,LocationName:"3AXpBdsF6gUgAN4F1QXTBdkF4gXZBd8FIADiBdkF3AXZBeoF",Address1:"חזון דוד",Address2:"",City:"מודיעין עילית",State:"ישראל",Country:"Israel",Description:"לשכת מודיעין עילית",Directions:"מרכז חזון דוד, קומה 1",ZipCode:"",Latitude:31.9259095,Longitude:35.0404295,Distance:29938.57851695812,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2349,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_ModiinIlit",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:854,LocationName:"3AXpBdsF6gUgANAF6QXTBdUF0wU=",Address1:"דרך מנחם בגין 1",Address2:"מרכז צימר",City:"אשדוד",State:"ישראל",Country:"Israel",Description:"לשכת אשדוד",Directions:"",ZipCode:"",Latitude:31.7889333,Longitude:34.6412574,Distance:34888.33452635172,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2215,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Ashdod",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:816,LocationName:"3AXpBdsF6gUgANcF0wXoBdQF",Address1:"דוד שמעוני 42",Address2:"",City:"חדרה",State:"ישראל",Country:"Israel",Description:"לשכת חדרה",Directions:"",ZipCode:"",Latitude:32.4382516,Longitude:34.9101099,Distance:41529.99928725659,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2144,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Hadera",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:859,LocationName:"3AXpBdsF6gUgANEF2QXqBSAA6QXeBekF",Address1:"אבא נעמת 1",Address2:"",City:"בית שמש",State:"ישראל",Country:"Israel",Description:"לשכת בית שמש",Directions:"",ZipCode:"",Latitude:31.7498587,Longitude:34.988725,Distance:41598.30155020139,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2225,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_BeitShemesh",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:824,LocationName:"3AXpBdsF6gUgAN4F0QXpBegF6gUgAOYF2QXVBd8F",Address1:"תיכון הראל",Address2:"",City:"מבשרת ציון",State:"ישראל",Country:"Israel",Description:"לשכת מבשרת ציון",Directions:"",ZipCode:"",Latitude:31.7933294,Longitude:35.1471307,Distance:47057.66111217791,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2159,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Mevaseret",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1019,LocationName:"3AXpBdsF6gUgAOcF3AXgBdMF2QXUBSAAIABCBkQGRgYvBkoGJwY=",Address1:" מעבר קלנדיה",Address2:"",City:"ירושלים",State:"ישראל",Country:"Israel",Description:"לשכת קלנדיה  قلنديا",Directions:"",ZipCode:"",Latitude:31.8617771,Longitude:35.2279515,Distance:48743.804310150634,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2882,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Kalandia",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1071,LocationName:"3AXpBdsF6gUgAOkF0wXoBdUF6gU=",Address1:"מנחם בגין 4",Address2:"",City:"שדרות",State:"ישראל",Country:"Israel",Description:"לשכת שדרות",Directions:"מרכז אבני החושן",ZipCode:"",Latitude:31.6750573,Longitude:34.5785472,Distance:48829.31393747158,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:3078,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Sderot",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:855,LocationName:"3AXpBdsF6gUgANAF6QXnBdwF1QXfBQ==",Address1:"ברל כצנלסון 9",Address2:"",City:"אשקלון",State:"ישראל",Country:"Israel",Description:"לשכת אשקלון",Directions:"",ZipCode:"",Latitude:31.6619595,Longitude:34.5872596,Distance:49861.33143456595,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2217,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Ashkelon",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1073,LocationName:"3AXpBdsF6gUgAOcF6AXZBeoFIADSBeoF",Address1:"ככר פז 3",Address2:"",City:"קרית גת",State:"ישראל",Country:"Israel",Description:"לשכת קרית גת",Directions:"קניון קרית גת",ZipCode:"",Latitude:31.611148,Longitude:34.768459,Distance:52033.98740435914,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:3086,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_KiryatGat",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1038,LocationName:"3AXpBdsF6gUgANAF6AXZBdAF3AU=",Address1:"יהודה 5",Address2:"",City:"אריאל",State:"ישראל",Country:"Israel",Description:"לשכת אריאל",Directions:"",ZipCode:"",Latitude:31.756822,Longitude:35.2207063,Distance:54953.57155885844,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2991,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Ariel",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1599,LocationName:"3AXpBdsF6gUgAOYF1QXoBSAA0QXQBdQF6AUgADUGSAYxBiAAKAYnBkcGMQY=",Address1:"257 אל מדינה אל מונאוורה ",Address2:"צור באהר",City:"ירושלים",State:"ישראל",Country:"Israel",Description:"לשכת צור באהר صور باهر",Directions:"",ZipCode:"",Latitude:31.73865,Longitude:35.232517,Distance:57123.71392567201,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:5550,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Zurbaher",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:893,LocationName:"3AXpBdsF6gUgAN4F4gXcBdQFIADQBdMF1QXeBdkF3QUgAA==",Address1:"דרך קדם 5",Address2:"",City:"מעלה אדומים",State:"ישראל",Country:"Israel",Description:"לשכת מעלה אדומים",Directions:"",ZipCode:"",Latitude:31.7714714,Longitude:35.298434,Distance:59764.285530163106,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2297,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_MaaleAdomim",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:2265,LocationName:"3AXpBdsF6gUgANAF1QXdBSAA0AXcBSAA5AXXBd0F",Address1:"אל מדינה",Address2:"",City:"אום אל פחם",State:"ישראל",Country:"Israel",Description:"לשכת אום אל פחם",Directions:"",ZipCode:"",Latitude:32.525567,Longitude:35.15457,Distance:60656.49920934427,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:8977,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_UmmElFahem",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1037,LocationName:"3AXpBdsF6gUgANkF5wXgBeIF3QU=",Address1:"התמר 2",Address2:"",City:"יקנעם",State:"ישראל",Country:"Israel",Description:"לשכת יקנעם",Directions:"",ZipCode:"",Latitude:32.6595831,Longitude:35.1051293,Distance:71133.48241796822,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2989,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Yokneam",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:841,LocationName:"3AXpBdsF6gUgAOAF6gXZBdEF1QXqBQ==",Address1:"שדרות ירושלים 10",Address2:"",City:"נתיבות",State:"ישראל",Country:"Israel",Description:"לשכת נתיבות",Directions:"",ZipCode:"",Latitude:31.4248982,Longitude:34.6006661,Distance:74643.21694339486,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2194,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Netivot",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:858,LocationName:"3AXpBdsF6gUgAOIF5AXVBdwF1AU=",Address1:"יהושע חנקין 1",Address2:"",City:"עפולה",State:"ישראל",Country:"Israel",Description:"לשכת עפולה",Directions:"",ZipCode:"",Latitude:32.603155,Longitude:35.297645,Distance:75709.47253563054,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2223,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Afula",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:849,LocationName:"3AXpBdsF6gUgAOgF1AXYBQ==",Address1:"עיריית רהט",Address2:"בניין העירייה",City:"רהט",State:"ישראל",Country:"Israel",Description:"לשכת רהט",Directions:"",ZipCode:"",Latitude:31.396149,Longitude:34.758438,Distance:75888.99968453907,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2205,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Rahat",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:856,LocationName:"3AXpBdsF6gUgANcF2QXkBdQF",Address1:"שדרות פל ים 15 א ",Address2:"",City:"חיפה",State:"ישראל",Country:"Israel",Description:"לשכת חיפה",Directions:"",ZipCode:"",Latitude:32.8160875,Longitude:35.002703,Distance:84227.50627367452,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2219,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Haifa",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:978,LocationName:"3AXpBdsF6gUgAOcF6AXZBdUF6gUgACgA5wXgBdkF1QXfBSAA6QXiBegFIADUBeYF5AXVBd8FKQA=",Address1:"דרך חיפה 52",Address2:"",City:"קרית אתא",State:"ישראל",Country:"Israel",Description:"לשכת קריות (קניון שער הצפון)",Directions:"קניון הצפון קומה 1",ZipCode:"",Latitude:32.8092936,Longitude:35.0750542,Distance:85454.71324178624,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2744,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Krayot",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:861,LocationName:"IADcBekF2wXqBSAA4AXVBeMFIADUBdIF3AXZBdwFIAAoAOAF5gXoBeoFIADiBdkF3AXZBeoFKQA=",Address1:"מעלה יצחק 29",Address2:"",City:"נוף הגליל",State:"ישראל",Country:"Israel",Description:" לשכת נוף הגליל (נצרת עילית)",Directions:"",ZipCode:"",Latitude:32.7170967,Longitude:35.3358718,Distance:87845.19243460955,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2229,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_NofHagalil",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:842,LocationName:"3AXpBdsF6gUgANEF0AXoBSAA6QXRBeIF",Address1:"התקווה 4",Address2:"קריית הממשלה",City:"באר שבע",State:"ישראל",Country:"Israel",Description:"לשכת באר שבע",Directions:"",ZipCode:"",Latitude:31.2453384,Longitude:34.799282,Distance:92598.45590201003,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2196,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Beersheva",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:852,LocationName:"3AXpBdsF6gUgAOIF2wXVBQ==",Address1:"שלום הגליל 1",Address2:"",City:"עכו",State:"ישראל",Country:"Israel",Description:"לשכת עכו",Directions:"",ZipCode:"",Latitude:32.9197962,Longitude:35.0932209,Distance:97624.76668889544,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2211,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Akko",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:889,LocationName:"3AXpBdsF6gUgAOEF1wUnAOAF2QXfBQ==",Address1:"עיריית סח'נין",Address2:"",City:"סחנין",State:"ישראל",Country:"Israel",Description:"לשכת סח'נין",Directions:"",ZipCode:"",Latitude:32.8600469,Longitude:35.3048816,Distance:99534.31044857082,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2285,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_sachnin",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:853,LocationName:"3AXpBdsF6gUgAOAF1AXoBdkF1AUgAA==",Address1:"אירית 2",Address2:"קניון נהריה",City:"נהריה",State:"ישראל",Country:"Israel",Description:"לשכת נהריה",Directions:"",ZipCode:"",Latitude:32.9901794,Longitude:35.0953318,Distance:105147.09416701035,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2213,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Naharia",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1822,LocationName:"3AXpBdsF6gUgANMF2QXoBSAA0AXcBSAA0AXhBdMF",Address1:"אל ג'בל",Address2:"מועצה מקומית דיר אל אסד",City:"דיר אל אסד",State:"ישראל",Country:"Israel",Description:"לשכת דיר אל אסד",Directions:"",ZipCode:"",Latitude:32.935872,Longitude:35.2667026,Distance:105305.99825229103,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:5901,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_DirElAsad",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:868,LocationName:"3AXpBdsF6gUgANsF6AXeBdkF0AXcBQ==",Address1:"החרושת 9",Address2:"",City:"כרמיאל",State:"ישראל",Country:"Israel",Description:"לשכת כרמיאל",Directions:"מרכז ניצנים",ZipCode:"",Latitude:32.9223331,Longitude:35.3045914,Distance:105570.06812651834,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2239,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Karmiel",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:860,LocationName:"3AXpBdsF6gUgANgF0QXoBdkF1AU=",Address1:"יהודה הלוי 1",Address2:"מרכז ביג פאשן דנילוף",City:"טבריה",State:"ישראל",Country:"Israel",Description:"לשכת טבריה",Directions:"",ZipCode:"",Latitude:32.7905464,Longitude:35.5337028,Distance:105928.37614783089,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2227,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Tveria",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:951,LocationName:"3AXpBdsF6gUgAN4F4gXcBdUF6gUgAOoF6AXpBdkF1wXQBQ==",Address1:"בן גוריון 1",Address2:"",City:"מעלות תרשיחא",State:"ישראל",Country:"Israel",Description:"לשכת מעלות תרשיחא",Directions:"",ZipCode:"",Latitude:33.0125724,Longitude:35.2842155,Distance:113697.07283765133,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2654,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Maalot",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:843,LocationName:"3AXpBdsF6gUgANMF2QXeBdUF4AXUBQ==",Address1:"בניין עיריית דימונה",Address2:"",City:"דימונה",State:"ישראל",Country:"Israel",Description:"לשכת דימונה",Directions:"",ZipCode:"",Latitude:31.0645166,Longitude:35.0325507,Distance:115142.7470903149,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2198,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Dimona",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:866,LocationName:"3AXpBdsF6gUgAOYF5AXqBQ==",Address1:"וייצמן 4",Address2:"",City:"צפת",State:"ישראל",Country:"Israel",Description:"לשכת צפת",Directions:"",ZipCode:"",Latitude:32.9575443,Longitude:35.4982255,Distance:118369.1964897553,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2235,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Zefat",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:1327,LocationName:"3AXpBdsF6gUgAOcF5gXoBdkF3wU=",Address1:"מרכז מסחרי איתן,קצרין ",Address2:"",City:"קצרין",State:"ישראל",Country:"Israel",Description:"לשכת קצרין",Directions:"",ZipCode:"",Latitude:32.990998,Longitude:35.689865,Distance:132275.10511012285,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:4706,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_Katzrin",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:867,LocationName:"3AXpBdsF6gUgAOcF6AXZBeoFIADpBd4F1QXgBdQF",Address1:" 37 הרצל",Address2:"",City:"קרית שמונה",State:"ישראל",Country:"Israel",Description:"לשכת קרית שמונה",Directions:"עיריית קרית שמונה",ZipCode:"",Latitude:33.2067897,Longitude:35.5676243,Distance:145121.86858249147,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2237,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"ShowDate_KiryatShmona",ServiceTypeId:0,MaxWaitingTime:0},{OrganizationId:56,OrganizationName:"רשות האוכלוסין וההגירה",LocationId:872,LocationName:"3AXpBdsF6gUgANAF2QXcBeoF",Address1:"שדרות התמרים 2",Address2:"",City:"אילת",State:"ישראל",Country:"Israel",Description:"לשכת אילת",Directions:"",ZipCode:"",Latitude:29.5549831,Longitude:34.9543557,Distance:280466.4682034198,WaitingTime:0,ShowStats:!1,IsFavorite:!1,ServiceCount:1,LastUseDate:"",HasCalendarService:!0,HasFIFOService:!0,ServiceId:2247,ServiceHasFIFO:!1,DynamicFormsEnabled:!0,PhoneNumber:"",ExtRef:"Eilat",ServiceTypeId:0,MaxWaitingTime:0}]}getDepartments(){return this.departments}}const t={ID_KEYPAD:"ID_KEYPAD",PHONE_KEYPAD:"PHONE_KEYPAD",mobileNumber:"mobileNumber"};class i{constructor({backendService:e}){this.observer=this.buildIntersectionObserver(),this.expectedNodesWithCallbacks=new Map,this.backendService=e,this.notifyShouldEnterSmsCode=this.debounce((()=>{this.backendService.notify("enterSmsCode")}),800)}buildIntersectionObserver(){return new IntersectionObserver(this.handleIntersection.bind(this),{rootMargin:"0px",threshold:1})}handleIntersection(e,t){e.forEach((e=>{e.isIntersecting&&this.expectedNodesWithCallbacks.has(e.target)&&(this.expectedNodesWithCallbacks.get(e.target)(),this.expectedNodesWithCallbacks.delete(e.target),this.observer.unobserve(e.target))}))}doWhenElementVisible(e,t){this.expectedNodesWithCallbacks.set(e,t),this.observer.observe(e)}fillByMySelf(){this.backendService.getUserData().then((e=>{this.fill(e)}))}fill(e){this.fillIDTeudat(e.idNumber),this.fillPhoneShort(e.shortMobilePhone),this.fillMobileNumber(e.phoneNumber),this.registerAutoFiller(e)}registerAutoFiller(e){const i=this.debounce((()=>{this.fillIDTeudat(e.idNumber),this.fillPhoneShort(e.shortMobilePhone),this.fillMobileNumber(e.phoneNumber)}),250);new MutationObserver((e=>{e.forEach((e=>{if("attributes"===e.type){const a=e.target.id;t.hasOwnProperty(a)&&i()}}))})).observe(document.body,{childList:!0,subtree:!0,attributes:!0})}debounce(e,t){let i=null;return function(){const a=this,n=arguments;clearTimeout(i),i=setTimeout((()=>{e.apply(a,n)}),t)}}isVisible(e){return e&&null!==e.offsetParent}fillIDTeudat(e){const i=document.querySelector(`#${t.ID_KEYPAD}`),a=t=>{this.setValueAndDispatchEvent(t,e),this.submitFormAfterDelay('form[name="questionnaireForm"] button',100)};i&&(this.isVisible(i)?a(i):this.doWhenElementVisible(i,(()=>a(i))))}fillPhoneShort(e){const i=document.querySelector(`#${t.PHONE_KEYPAD}`),a=t=>{this.setValueAndDispatchEvent(t,e),this.submitFormAfterDelay('form[name="questionnaireForm"] button',100)};i&&(this.isVisible(i)?a(i):this.doWhenElementVisible(i,(()=>a(i))))}fillMobileNumber(e){const i=document.querySelector(`#${t.mobileNumber}`),a=t=>{this.setValueAndDispatchEvent(t,e),this.submitFormAfterDelay('form[name="smsSettingsForm"] input[type="submit"]',200),this.focusElementAfterDelay("#verficationNumber",400)};i&&(this.isVisible(i)?a(i):this.doWhenElementVisible(i,(()=>a(i))))}setValueAndDispatchEvent(e,t){e.value=t;const i=new Event("input");e.dispatchEvent(i)}submitFormAfterDelay(e,t){setTimeout((()=>{const t=document.querySelector(e);this.isVisible(t)?t.click():console.warn("submitFormAfterDelay continueButton not found",Date.now())}),t)}focusElementAfterDelay(e,t){setTimeout((()=>{const t=document.querySelector(e);t&&(t.focus(),this.notifyShouldEnterSmsCode())}),t)}}class a{constructor({gifPath:e,backendService:t}){this.backendService=t,this.statusValue=null,this.lastCheckDatetime=null,this.resultList=null,this.gifPath=e,this.loadingImage=null}createNode(){const e=this.createElement("div","teudat-container");this.loadingImage=this.createLoadingImage();const t=this.createRow([this.createElement("span",null,"Статус:&nbsp;"),this.statusValue=this.createElement("span",null,"Ищем..."),this.loadingImage]),i=this.createRow([this.createElement("span",null,"Последняя проверка:&nbsp;"),this.lastCheckDatetime=this.createElement("span",null,"...")]),a=this.createRow([this.resultList=this.createElement("ul",null)]);return e.appendChild(t),e.appendChild(i),e.appendChild(a),e}changeDepartment(e){this.statusValue.innerText="Ищем... "+e}changeLastCheckDatetime(){const e=(new Date).toLocaleTimeString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1});this.lastCheckDatetime.innerText=e}changeStatusAsWorking(){this.statusValue.innerText="Ищем..."}changeStatusAsFinished(){this.statusValue.innerText="Закончили"}changeStatusAsContinue(){this.statusValue.innerText="Продолжим поиск через несколько минут..."}changeStatusAsError(){this.statusValue.innerText="Ошибка. Пожалуйста, перезагрузите страницу и попробуйте снова.",this.loadingImage.style.display="none"}clearResults(){this.resultList.innerHTML=""}isCloseEnough(e){return new Date(e).getTime()-Date.now()<13824e5}appendResult(e){const t=e.href,i=e.name,a=e.date,n=e.serviceId;let s=this.createElement("span",null,"no slots");if(a){const e=this.isCloseEnough(a);e&&(console.warn("CLOSE ENOUGH",i,a,Date.now()),this.backendService.notify("closeDate",{department:{name:i,serviceId:n},date:a}));const r=new Date(a).toLocaleDateString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit"});s=this.createElement("a",null,r),s.href=t,s.target="_blank",e&&(s.style.color="forestgreen")}const r=this.createElement("li",null,[this.createElement("span",null,i+":&nbsp;"),s]);this.resultList.appendChild(r)}createRow(e){const t=this.createElement("div","teudat-row");return e.forEach((e=>t.appendChild(e))),t}createLoadingImage(){const e=document.createElement("img");return e.src=this.gifPath,e.style.width="25px",e.style.height="25px",e}createElement(e,t,i){const a=document.createElement(e);return t&&a.classList.add(t),Array.isArray(i)?i.forEach((e=>a.appendChild(e))):"string"==typeof i&&(a.innerHTML=i),a}renderTo(e){e.appendChild(this.node)}}const n=18e4;class s{constructor({departments:e,resultTable:t,xhrSubstitute:i,backendService:a}){this.backendService=a,this.resultTable=t,this.departments=e,this.xhrSubstitute=i,this.fallback=null,this.resultTableInserted=!1,this.tokenConfig={},this.originalLocationSearchUrl=null,this.xhrSubstitute.addHandler("https://central.myvisit.com/CentralAPI/LocationSearch",((e,t)=>{this.handleLocationSearchResponse(JSON.parse(t)),this.originalLocationSearchUrl=e}))}loadRequestConfig(){const e=document.documentElement.dataset.syncConfig;this.tokenConfig=void 0===e?{}:JSON.parse(e)}getRequestHeaders(){return{accept:"application/json, text/plain, */*","accept-language":"en","application-api-key":this.tokenConfig["application-api-key"],"application-name":this.tokenConfig["application-name"],preparedvisittoken:this.tokenConfig.preparedvisittoken,"user-agent":this.tokenConfig["user-agent"],"cache-control":"no-cache",pragma:"no-cache"}}queryLocation(){return new Promise(((e,t)=>{console.log("START REQUEST",Date.now());const i=this.getRequestHeaders();if(void 0===i.preparedvisittoken)return console.warn("Can't find preparedvisittoken"),void e({});fetch(this.originalLocationSearchUrl,{headers:i,referrer:"https://myvisit.com/",referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors",credentials:"include"}).then((t=>{if(t.ok)return t.json().then((i=>{t.status,e(i)}));this.backendService.notify("reloadPage"),e({}),console.warn("BAD RESPONSE",t)})).catch((t=>{e({}),console.warn("BAD RESPONSE",t)}))}))}handleLocationSearchResponse(e){if(!e||!e.Success||!e.Results)return void this.resultTable.changeStatusAsError();if(!this.hasResultDateInLocationName(e.Results[0]))return console.warn("Can't find date in location name"),void(this.fallback&&(console.warn("Fall back to original location search"),this.fallback()));const t=document.querySelector(".locationSearchInput.ng-isolate-scope")?.parentNode.parentNode;if(!t)return void console.warn("Can't find location block");this.resultTableInserted?this.resultTable.clearResults():(t.prepend(this.resultTable.createNode()),this.resultTableInserted=!0),this.resultTable.changeLastCheckDatetime(),this.resultTable.changeStatusAsWorking();const i=this.departments.getGoodDepartmentServiceIds();e.Results.forEach((e=>{e.ServiceId&&i.includes(e.ServiceId)&&this.addDepartmentToResultTable(e)})),console.log("WAITING FOR NEXT REQUEST",Date.now(),Date.now()+n),setTimeout((async()=>{this.loadRequestConfig();const e=await this.queryLocation();this.handleLocationSearchResponse(e)}),n)}hasResultDateInLocationName(e){return null!==this.matchDateFromLocationName(e.LocationName)}matchDateFromLocationName(e){return e.match(/(\d{2})\/(\d{2})\/(\d{4})/)}addDepartmentToResultTable(e){const t=e.LocationName,i=this.matchDateFromLocationName(t),a=i[0]?`${i[3]}-${i[2]}-${i[1]}`:null,n=e.ExtRef.replace(/ShowDate_/g,"");a?this.resultTable.appendResult({href:`https://myvisit.com/#!/home/service/${e.ServiceId}`,name:n,date:a,serviceId:e.ServiceId}):this.resultTable.appendResult({href:`https://myvisit.com/#!/home/service/${e.ServiceId}`,name:n})}fallbackWhenDateNotInLabel(e){this.fallback=e}}class r{constructor(e){this.token=e,this.userData=null}async getUserData(){return null!==this.userData?this.userData:this.get("getMySelf").then((e=>e.ok?e.json():{user:null,status:e.status})).then((e=>(this.userData=e?.user,this.userData)))}async notify(e,t={}){return this.query(`notify?reason=${e}`,{reason:e,data:t})}async get(e){return this.query(e,{},"GET")}async query(e,t,i="POST"){return fetch(`https://myvisit.appetited.com/api/${e}`,{method:i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:"GET"!==i?JSON.stringify(t):null})}}class o{constructor(){this._items=[]}enqueue(e){this._items.push(e)}dequeue(){return this._items.shift()}get size(){return this._items.length}}class d extends o{constructor(){super(),this._pendingPromise=!1}enqueue(e){return new Promise(((t,i)=>{super.enqueue({action:e,resolve:t,reject:i}),this.dequeue()}))}async dequeue(){if(this._pendingPromise)return!1;let e=super.dequeue();if(!e)return!1;try{this._pendingPromise=!0;let t=await e.action(this);this._pendingPromise=!1,e.resolve(t)}catch(t){this._pendingPromise=!1,e.reject(t)}finally{this.dequeue()}return!0}}class c{constructor({departments:e,resultTable:t,backendService:i}){this.preventContinue=!1,this.backendService=i,this.resultTable=t,this.resultTableInserted=!1,this.departments=e,this.tokenConfig={}}loadRequestConfig(){const e=document.documentElement.dataset.syncConfig;this.tokenConfig=void 0===e?{}:JSON.parse(e)}#a(){return new Promise((e=>setTimeout(e,5e3)))}async start(){const e=document.querySelector(".locationSearchInput.ng-isolate-scope")?.parentNode.parentNode;if(!e)return void console.warn("Can't find location block");this.resultTableInserted?this.resultTable.clearResults():(e.prepend(this.resultTable.createNode()),this.resultTableInserted=!0),this.resultTable.changeLastCheckDatetime(),this.resultTable.changeStatusAsWorking();const t=this.departments,i=new d,a=({departmentInfo:e}={})=>async()=>(await this.loadRequestConfig(),this.resultTable.changeDepartment(e.Label),await this.sendMessage({action:"page-worker-work-with",department:e}),this.preventContinue?{department:e,data:{Success:!1,Message:"STOPPED"}}:await this.requestSlots(e));for(let e of t){let t=e;i.enqueue(a({departmentInfo:t})).then((({department:e,data:t})=>{console.log("QUEUE",{department:e,data:t}),t.Success?(console.warn(arguments,e,t),console.log(e.name,JSON.stringify(t.Results),Date.now()),t.TotalResults>0?this.highlightAddress(e,t.Results):this.highlightAddress(e,[])):this.resultTable.changeStatusAsError()})),i.enqueue(this.#a)}i.enqueue((()=>new Promise((e=>{e()})))).then((()=>{this.resultTable.changeStatusAsContinue(),console.log("WAITING FOR NEXT REQUEST",Date.now(),Date.now()+5e3),this.sendMessage({action:"page-worker-finish"}),setTimeout((()=>{this.start()}),18e4)}))}async sendMessage(e){return console.log("sendMessage",e),!0}getRequestHeaders(){return{accept:"application/json, text/plain, */*","accept-language":"en","application-api-key":this.tokenConfig["application-api-key"],"application-name":this.tokenConfig["application-name"],"cache-control":"no-cache",pragma:"no-cache",preparedvisittoken:this.tokenConfig.preparedvisittoken,"sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site"}}requestSlots(e){return new Promise(((t,i)=>{console.log("START REQUEST",Date.now());const a=this.getRequestHeaders();if(void 0===a.preparedvisittoken)return console.warn("Can't find preparedvisittoken"),void t({department:e,data:{Success:!1,Message:"Can't find preparedvisittoken"}});const n=this.getCurrentDateString();fetch(`https://central.myvisit.com/CentralAPI/SearchAvailableDates?maxResults=2&serviceId=${e.ServiceId}&startDate=${n}`,{headers:a,referrer:"https://myvisit.com/",referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors",credentials:"include"}).then((i=>{const a=i.status;if(i.ok)return i.json().then((i=>{t({department:e,data:i}),console.log("RESPONSE",{department:e,data:i},a)}));403!==a&&this.backendService.notify("reloadPage"),t({department:e,data:{Success:!1,Message:"BAD RESPONSE"}}),console.warn("BAD RESPONSE",i)})).catch((i=>{this.preventContinue=!0,this.backendService.notify("blockedPage"),t({department:e,data:{Success:!1,Message:i.message}}),console.log("BAD RESPONSE",i)}))}))}getCurrentDateString(){const e=new Date;return`${new Intl.DateTimeFormat("en",{year:"numeric"}).format(e)}-${new Intl.DateTimeFormat("en",{month:"2-digit"}).format(e)}-${new Intl.DateTimeFormat("en",{day:"2-digit"}).format(e)}`}highlightAddress(e,t){let i={};t&&t.length?(this.resultTable.appendResult({href:`https://myvisit.com/#!/home/service/${e.ServiceId}`,name:e.Label,date:t[0].calendarDate.substring(0,10),serviceId:e.ServiceId}),i.color="darkseagreen",i.text=t[0].calendarDate.substring(0,10)):(this.resultTable.appendResult({href:`https://myvisit.com/#!/home/service/${e.ServiceId}`,name:e.Label}),i.color="currentcolor"),this.departments.highlightAddress(e,i)}}const l=new class{constructor(){this.mapHandlers=new Map}refineUrl(e){const t=new URL(e);return t.origin+t.pathname}addHandler(e,t){this.mapHandlers.set(this.refineUrl(e),t)}processRequest(e){if(4===e.target.readyState&&200===e.target.status){const t=this.mapHandlers.get(this.refineUrl(e.target.responseURL));t&&t(e.target.responseURL,e.target.response)}}substitute(){const e=window.XMLHttpRequest,t=this;window.XMLHttpRequest=function(){return new Proxy(new e,{get(e,t,i){const a=e[t];return a instanceof Function?function(...t){return a.apply(this===i?e:this,t)}:a},set:(e,i,a)=>"onreadystatechange"===i||"onload"===i?(e[i]=function(i){t.processRequest(i),a.apply(e,arguments)},!0):(e[i]=a,!0)})}}};function S(e){if(!(e in document.documentElement.dataset))return null;const t=document.documentElement.dataset[e];return JSON.parse(t)}l.substitute(),(new class{constructor(){this.lastMousePosition={x:0,y:0}}simulateMovement(){const e=10*Math.random()-5,t=10*Math.random()-5;this.lastMousePosition.x+=e,this.lastMousePosition.y+=t;const i=new MouseEvent("mousemove",{clientX:this.lastMousePosition.x,clientY:this.lastMousePosition.y});window.dispatchEvent(i)}simulateScroll(){const e=10*Math.random(),t=new WheelEvent("wheel",{deltaY:e});window.dispatchEvent(t)}randomize(){setTimeout((()=>{this.start(),setTimeout((()=>{this.stop(),this.randomize()}),15e3*Math.random())}),15e3*Math.random())}start(){this.intervalId=setInterval((()=>{this.simulateMovement(),this.simulateScroll()}),400)}stop(){this.intervalId&&clearInterval(this.intervalId)}}).randomize(),(async()=>{const t=S("syncToken");if(S("syncIsDisabled"))return void console.warn("Disabled by user");if(!t)return void console.warn("Token not found!");const n=new r(t),o=document.documentElement.dataset.gifPath,d=new a({gifPath:o,backendService:n}),u=new e;new s({departments:u,resultTable:d,xhrSubstitute:l,backendService:n}).fallbackWhenDateNotInLabel((()=>{new c({departments:u,resultTable:d,backendService:n}).start()})),new i({backendService:n}).fillByMySelf(),delete document.documentElement.dataset.gifPath})()})();